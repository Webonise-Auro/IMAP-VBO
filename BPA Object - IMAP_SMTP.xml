<process name="IMAP/SMTP" version="1.0" bpversion="5.0.24.0" narrative="This VBO provides all the basic actions needed to interact with mail servers using IMAP and SMTP protocols." type="object" runmode="Exclusive" preferredid="a23ac218-197c-4496-8c16-c1d21ef6c1a4">
  <appdef>
    <element name="Application Root">
      <id>3b2c50e6-d920-4496-9307-3c630be5844e</id>
      <type>Application</type>
      <basetype>Application</basetype>
      <datatype>unknown</datatype>
      <diagnose>False</diagnose>
    </element>
  </appdef>
  <view>
    <camerax>-25</camerax>
    <cameray>0</cameray>
    <zoom version="2">1.25</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <subsheet subsheetid="860c1dd0-cfc0-4b47-ae49-4ffd5c0196c7" type="CleanUp" published="True">
    <name>Clean Up</name>
    <view>
      <camerax>0</camerax>
      <cameray>-63</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="b9ee1718-8bde-4e00-bceb-a19b5ed2be71" type="Normal" published="True">
    <name>Save Attachments</name>
    <view>
      <camerax>81</camerax>
      <cameray>-76</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="aca4df97-d2e0-4cfe-9a50-a8628baf8707" type="Normal" published="True">
    <name>Send Message</name>
    <view>
      <camerax>-117</camerax>
      <cameray>69</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="d4cd3b12-b1d4-4a7b-937b-f9e32b099fb3" type="Normal" published="True">
    <name>Delete Message</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="b6f2c71c-22e0-4e6a-b736-6ed78b0c7870" type="Normal" published="True">
    <name>Get Message</name>
    <view>
      <camerax>0</camerax>
      <cameray>-23</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="1430d38d-4e03-47d5-bb8c-c9978ae1aeca" type="Normal" published="True">
    <name>Search UID(s)</name>
    <view>
      <camerax>-126</camerax>
      <cameray>215</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="572ab18e-33ed-4088-b341-0c8fc5ec05a7" type="Normal" published="False">
    <name>Select Folder</name>
    <view>
      <camerax>0</camerax>
      <cameray>-126</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="1a2fb845-7510-4def-85a0-41c6825a1870" type="Normal" published="True">
    <name>List Folders(recursively)</name>
    <view>
      <camerax>0</camerax>
      <cameray>63</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="7749f7db-1505-4566-8fc6-f99f4a78515d" type="Normal" published="False">
    <name>Close Connection</name>
    <view>
      <camerax>0</camerax>
      <cameray>-21</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="c227143e-75fe-4016-b5a7-7d6cfe85443f" type="Normal" published="False">
    <name>Logout</name>
    <view>
      <camerax>0</camerax>
      <cameray>42</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="dab928dd-5fd3-48ef-9756-4d64792ab888" type="Normal" published="False">
    <name>Login</name>
    <view>
      <camerax>0</camerax>
      <cameray>-21</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="342cb078-d25f-47a6-9c05-02880b01ae5e" type="Normal" published="True">
    <name>Configure IMAP</name>
    <view>
      <camerax>135</camerax>
      <cameray>211</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="a07911cf-dcf6-46b7-9f4b-821156df7559" type="Normal" published="False">
    <name>Connect IMAP</name>
    <view>
      <camerax>0</camerax>
      <cameray>-21</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="65c494bc-32bf-4bc0-820f-b2414bae6797" type="Normal" published="True">
    <name>List Messages</name>
    <view>
      <camerax>-110</camerax>
      <cameray>304</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <stage stageid="ec602342-ed75-4d8d-ac8d-8ce68f2a898d" name="Start" type="Start">
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>bee86242-e9b7-4c0f-8ed9-4754da6fa4be</onsuccess>
  </stage>
  <stage stageid="bee86242-e9b7-4c0f-8ed9-4754da6fa4be" name="End" type="End">
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>90</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="b7a8f243-dc80-4df4-ae27-9e5aafb8a33a" name="Stage1" type="ProcessInfo">
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <references>
      <reference>C:\Windows\Microsoft.NET\Framework64\v4.0.30319\System.dll</reference>
      <reference>C:\Windows\Microsoft.NET\Framework64\v4.0.30319\System.IO.dll</reference>
      <reference>C:\Windows\Microsoft.NET\Framework64\v4.0.30319\System.Net.dll</reference>
      <reference>C:\Windows\Microsoft.NET\Framework64\v4.0.30319\System.Text.Encoding.dll</reference>
      <reference>C:\Windows\Microsoft.NET\Framework64\v4.0.30319\System.Data.dll</reference>
      <reference>C:\Windows\Microsoft.NET\Framework64\v4.0.30319\System.XML.dll</reference>
      <reference>C:\Windows\Microsoft.NET\Framework64\v4.0.30319\System.Text.RegularExpressions.dll</reference>
      <reference>C:\Windows\Microsoft.NET\Framework64\v4.0.30319\System.Collections.dll</reference>
      <reference>C:\Windows\Microsoft.NET\Framework64\v4.0.30319\System.Linq.dll</reference>
    </references>
    <imports>
      <import>System</import>
      <import>System.IO</import>
      <import>System.Net.Sockets</import>
      <import>System.Net.Security</import>
      <import>System.Text</import>
      <import>System.Data</import>
      <import>System.Text.RegularExpressions</import>
      <import>System.Collections.Generic</import>
      <import>System.Linq</import>
      <import>System.Net.Mail</import>
    </imports>
    <language>csharp</language>
    <globalcode><![CDATA[]]></globalcode>
    <code><![CDATA[TcpClient tcpc = null;
SslStream ssl = null;
byte[] dummy;
MemoryStream memStream;	

void closeConnection(){
	if(ssl != null){
		ssl.Close();
		ssl.Dispose();
		}
	if (tcpc != null){
		tcpc.Close();
		}
	}
	
string receiveResponse(string command)
{	
	try 
            { 	
				ssl.ReadTimeout = 3000;
                if (command != "") 
                { 
                    if (tcpc.Connected) 
                    { 
						dummy = Encoding.ASCII.GetBytes(command); 
                        ssl.Write(dummy, 0, dummy.Length); 
					} 
                    else 
                    { 
                        throw new ApplicationException("TCP CONNECTION DISCONNECTED"); 
                    } 
                } 
                ssl.Flush();
				byte[] b = new byte[2048];
				memStream = new MemoryStream();
				int byteRead = ssl.Read(b, 0, b.Length);
				while(byteRead > 0){
					memStream.Write(b, 0, byteRead);
					try {
							byteRead = ssl.Read(b, 0, b.Length);
						}
					catch(Exception){
						byteRead = 0;
						}
					}
				return Encoding.ASCII.GetString(memStream.ToArray());
            } 
            catch (Exception ex) 
            { 
               throw new ApplicationException(ex.Message); 
            } 
}]]></code>
  </stage>
  <stage stageid="95f2cb4b-320d-4c3d-ae50-5ddc3ce78823" name="Clean Up" type="SubSheetInfo">
    <subsheetid>860c1dd0-cfc0-4b47-ae49-4ffd5c0196c7</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="a1dc2cd3-18e3-460f-b6e2-4c87349b20ce" name="Start" type="Start">
    <subsheetid>860c1dd0-cfc0-4b47-ae49-4ffd5c0196c7</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>5be588f7-46f4-40e9-b898-367bb02798c1</onsuccess>
  </stage>
  <stage stageid="5be588f7-46f4-40e9-b898-367bb02798c1" name="End" type="End">
    <subsheetid>860c1dd0-cfc0-4b47-ae49-4ffd5c0196c7</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>90</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="ae63714e-67ee-4af8-9758-563aef3b57c3" name="Note1" type="Note">
    <subsheetid>860c1dd0-cfc0-4b47-ae49-4ffd5c0196c7</subsheetid>
    <narrative>Clean Up Page

This is an optional page where you might choose to perform some finalisation (or "cleanup") tasks as your business object is closed down.

The cleanup action will be called automatically immediately after closing your business object at the end of a business process.

You will not be able to call this action from a business process, nor will it be called at any other time than before the disposal of the business object.</narrative>
    <displayx>-180</displayx>
    <displayy>60</displayy>
    <displaywidth>180</displaywidth>
    <displayheight>230</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="9caaa652-6403-4231-a2fc-dcac6787e9b9" name="Note2" type="Note">
    <narrative>Initialise Page

This is an optional page where you might choose to perform some initialisation tasks after your business object is loaded.

The initialise action will be called automatically immediately after loading your business object.

You will not be able to call this action from a business process, nor will it be called at any other time than after the creation of the object.</narrative>
    <displayx>-180</displayx>
    <displayy>60</displayy>
    <displaywidth>180</displaywidth>
    <displayheight>230</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="674b41a6-eba0-497a-87bf-4d0af3eced5a" name="Configure IMAP" type="SubSheetInfo">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <narrative>Configures IMAP and SMTP settings for business object.</narrative>
    <displayx>-315</displayx>
    <displayy>-285</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="7c37dd56-1519-42c8-a5bb-f36add8dc875" name="Start" type="Start">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>30</displayx>
    <displayy>-165</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="IMAP Host" narrative="This is incoming mail server" stage="IMAP host" />
      <input type="number" name="IMAP port" narrative="This is port at wihich incoming mail server is connected" stage="IMAP port" />
      <input type="text" name="Username" narrative="Usrname by which to login in acoount" stage="Username" />
      <input type="password" name="Password" narrative="Password of the account" stage="Password" />
      <input type="text" name="SMTP Host" narrative="SMTP mail server" stage="SMTP Host" />
      <input type="number" name="SMTP Port" narrative="Port number for SMTP Server" stage="SMTP port" />
      <input type="flag" name="Enable SSL" narrative="SSL for SMTP" stage="Enable SSL" />
    </inputs>
    <onsuccess>94cd0249-6663-4552-b7a1-91b4e48aa08a</onsuccess>
  </stage>
  <stage stageid="6db0f2a6-246c-4ff8-813e-a12c52654fa3" name="End" type="End">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>30</displayx>
    <displayy>405</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="15ffb12b-f2b1-46fe-9b40-d1ce64b2d40b" name="IMAP host" type="Data">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>Domain name of IMAP server </narrative>
    <displayx>-360</displayx>
    <displayy>-135</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="2b332e36-fa7b-461a-91ae-71c39a70e564" name="IMAP port" type="Data">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>Port Number of IMAP server</narrative>
    <displayx>-285</displayx>
    <displayy>-135</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="f971827b-b278-4aaa-b274-1bee0fbfc1a6" name="Login" type="SubSheetInfo">
    <subsheetid>dab928dd-5fd3-48ef-9756-4d64792ab888</subsheetid>
    <narrative>Logs in to IMAP server using specified configurtion input.</narrative>
    <displayx>-255</displayx>
    <displayy>-165</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="ff0f3ef8-60e7-49cb-9bf8-5f7eb6938faa" name="Start" type="Start">
    <subsheetid>dab928dd-5fd3-48ef-9756-4d64792ab888</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-15</displayx>
    <displayy>-135</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>7cec5d82-b261-45eb-8068-54c9c6638258</onsuccess>
  </stage>
  <stage stageid="c3017347-2897-4b39-99e4-e52cbec56a5b" name="End" type="End">
    <subsheetid>dab928dd-5fd3-48ef-9756-4d64792ab888</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-15</displayx>
    <displayy>150</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="26803d3c-cfb2-4649-923b-f552a60f5023" name="Send Login Request" type="Code">
    <subsheetid>dab928dd-5fd3-48ef-9756-4d64792ab888</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-15</displayx>
    <displayy>45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="username" expr="[Username]" />
      <input type="password" name="password" expr="[Password]" />
    </inputs>
    <onsuccess>c3017347-2897-4b39-99e4-e52cbec56a5b</onsuccess>
    <code><![CDATA[string output=null;
if (tcpc == null || ssl == null) {
	output = "Connection with Imap Server is not established";
	closeConnection();
	throw new ApplicationException(output);
	}

try {
output = receiveResponse("$ LOGIN " + username + " " + password + "\r\n");
}
catch (Exception ex){
	output = ex.Message;
	closeConnection();
	throw ex;
	}

if (!output.Contains("$ OK")) {
	 closeConnection();
	 throw new ApplicationException("Invalid Credentials");
}
	]]></code>
  </stage>
  <stage stageid="100418e8-e194-48f1-834b-353bdf7d59d6" name="Logout" type="SubSheetInfo">
    <subsheetid>c227143e-75fe-4016-b5a7-7d6cfe85443f</subsheetid>
    <narrative>Logs Out from IMAP Server.</narrative>
    <displayx>-210</displayx>
    <displayy>-150</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="c434e04e-02bf-42b3-9ebb-fbc2dbd1cae6" name="Start" type="Start">
    <subsheetid>c227143e-75fe-4016-b5a7-7d6cfe85443f</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-15</displayx>
    <displayy>-135</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>65c8f8d7-e473-4677-9c12-72b3095b7af2</onsuccess>
  </stage>
  <stage stageid="9d833591-234d-4b07-8cc9-ffa216c48fe5" name="End" type="End">
    <subsheetid>c227143e-75fe-4016-b5a7-7d6cfe85443f</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-15</displayx>
    <displayy>45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="65c8f8d7-e473-4677-9c12-72b3095b7af2" name="Send Logout Request" type="Code">
    <subsheetid>c227143e-75fe-4016-b5a7-7d6cfe85443f</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-15</displayx>
    <displayy>-75</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>cd316921-c1b3-4b90-8ec0-d81eb338f71c</onsuccess>
    <code><![CDATA[string output=null;
if (tcpc == null || ssl == null) {
	output = "Connection with Imap Server is not established";
	closeConnection();
	throw new ApplicationException(output);
	}

try {
output = receiveResponse("$ LOGOUT\r\n");
}
catch (Exception ex){
	output = ex.Message;
	closeConnection();
	throw ex;
	}
	
if (!output.Contains("$ OK")) {
	 closeConnection();
	 throw new ApplicationException("Logout Failed");
}
]]></code>
  </stage>
  <stage stageid="60ee041d-16d6-4d4b-81b0-603f9c6a3807" name="Close Connection" type="SubSheetInfo">
    <subsheetid>7749f7db-1505-4566-8fc6-f99f4a78515d</subsheetid>
    <narrative>Closes the connection with IMAP server</narrative>
    <displayx>-210</displayx>
    <displayy>-165</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="d5d3c4b7-c29e-4626-86a0-f8d64220f1dd" name="Start" type="Start">
    <subsheetid>7749f7db-1505-4566-8fc6-f99f4a78515d</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>30</displayx>
    <displayy>-90</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>ca2f9c00-5303-4e0d-947f-19ec4cf4cb7d</onsuccess>
  </stage>
  <stage stageid="586c8f0c-34a1-45f2-9af2-66ad089009cd" name="End" type="End">
    <subsheetid>7749f7db-1505-4566-8fc6-f99f4a78515d</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>30</displayx>
    <displayy>30</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="ca2f9c00-5303-4e0d-947f-19ec4cf4cb7d" name="Close Connection" type="Code">
    <subsheetid>7749f7db-1505-4566-8fc6-f99f4a78515d</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>30</displayx>
    <displayy>-30</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>586c8f0c-34a1-45f2-9af2-66ad089009cd</onsuccess>
    <code><![CDATA[closeConnection();]]></code>
  </stage>
  <stage stageid="e0721cbd-a355-47f2-b626-fdd4de1681f9" name="List Folders(recursively)" type="SubSheetInfo">
    <subsheetid>1a2fb845-7510-4def-85a0-41c6825a1870</subsheetid>
    <narrative>
    </narrative>
    <displayx>-195</displayx>
    <displayy>-195</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="d9bb31ae-16c2-4d6e-8fbf-0e5b6bd111d2" name="Start" type="Start">
    <subsheetid>1a2fb845-7510-4def-85a0-41c6825a1870</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-15</displayx>
    <displayy>-135</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>ebadad7a-ca38-4099-921d-fc83680c1675</onsuccess>
  </stage>
  <stage stageid="cec02655-866d-49b4-b6bd-37af244f6def" name="End" type="End">
    <subsheetid>1a2fb845-7510-4def-85a0-41c6825a1870</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-15</displayx>
    <displayy>180</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="collection" name="FoldersList" narrative="This is response of request to imap server" stage="foldersList" />
    </outputs>
  </stage>
  <stage stageid="743ddc0f-2ae5-40dc-8ff3-17f63acb0f62" name="Send List Request" type="Code">
    <subsheetid>1a2fb845-7510-4def-85a0-41c6825a1870</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-15</displayx>
    <displayy>45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="collection" name="foldersList" stage="foldersList" />
    </outputs>
    <onsuccess>b9e0fcba-f53a-49c1-a325-aedd634b4768</onsuccess>
    <code><![CDATA[string output = null;
if (tcpc == null || ssl == null) {
	output = "Connection with Imap Server is not established";
	closeConnection();
	throw new ApplicationException(output);
	}

try {
output = receiveResponse("$ LIST " + "\"\"" + " \"*\"" + "\r\n"); 
string [] folders = Regex.Split(output, "\r\n");
foldersList = new DataTable();
foldersList.Columns.Add("Name"); 
	foreach(string line in folders){
		string value = Regex.Match(line,@"(?<=""\s"").*(?="")").Groups[0].Value;
		if(!String.IsNullOrEmpty(value)){
			DataRow row = foldersList.NewRow();
			row["Name"] = value;
			foldersList.Rows.Add(row);
		}
	}
}
catch (Exception ex){
	output = ex.Message;
	closeConnection();
	throw ex;
	}	

if (!output.Contains("$ OK")){
	throw new ApplicationException("No user is logged in to show list");
	}]]></code>
  </stage>
  <stage stageid="ec2c4b22-7e6b-4fb9-b2f3-f7e0dfb953f3" name="Select Folder" type="SubSheetInfo">
    <subsheetid>572ab18e-33ed-4088-b341-0c8fc5ec05a7</subsheetid>
    <narrative>
    </narrative>
    <displayx>-210</displayx>
    <displayy>-240</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="2f891957-9dd6-446d-ba06-b9256d0de710" name="Start" type="Start">
    <subsheetid>572ab18e-33ed-4088-b341-0c8fc5ec05a7</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>0</displayx>
    <displayy>-180</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="foldername" narrative="This is folder name to select" stage="foldername" />
    </inputs>
    <onsuccess>12212015-6074-42f0-bdf9-22987ae7e832</onsuccess>
  </stage>
  <stage stageid="566d1e19-9326-45a9-b8d5-d3c6aa2b9692" name="End" type="End">
    <subsheetid>572ab18e-33ed-4088-b341-0c8fc5ec05a7</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>0</displayx>
    <displayy>15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="cfec885b-edfd-4b0d-8ce4-3a1285624e94" name="Send Select Folder Request" type="Code">
    <subsheetid>572ab18e-33ed-4088-b341-0c8fc5ec05a7</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>0</displayx>
    <displayy>-60</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="foldername" expr="[foldername]" />
    </inputs>
    <onsuccess>566d1e19-9326-45a9-b8d5-d3c6aa2b9692</onsuccess>
    <code><![CDATA[string output = null;
if (tcpc == null || ssl == null) {
	output = "Connection with Imap Server is not established";
	closeConnection();
	throw new ApplicationException(output);
	}

try {
output = receiveResponse("$ SELECT " + foldername + "\r\n");
}
catch (Exception ex){
	output = ex.Message;
	closeConnection();
	throw ex;
	}	

if (!output.Contains("$ OK")){
	throw new ApplicationException("Folder does not exist or not logged in or server encountered an error");
	}

]]></code>
  </stage>
  <stage stageid="6c59c460-052c-4b17-b12b-73f7efed9e21" name="foldername" type="Data">
    <subsheetid>572ab18e-33ed-4088-b341-0c8fc5ec05a7</subsheetid>
    <loginhibit />
    <narrative>Name of folder from where Mail is accessed</narrative>
    <displayx>-225</displayx>
    <displayy>-90</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b0aecd01-9320-4f62-a1ec-825d02c1c257" name="Search UID(s)" type="SubSheetInfo">
    <subsheetid>1430d38d-4e03-47d5-bb8c-c9978ae1aeca</subsheetid>
    <narrative>Searches specific mails for provided input and gives unique UIDs of mails.</narrative>
    <displayx>-330</displayx>
    <displayy>-210</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="ad24bb61-205a-4546-9918-6846083a25e9" name="Start" type="Start">
    <subsheetid>1430d38d-4e03-47d5-bb8c-c9978ae1aeca</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-60</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="from" narrative="This is mail ID that sended the mail" stage="from" />
      <input type="text" name="to" narrative="This is Mail ID that received the mail" stage="to" />
      <input type="date" name="fromdate" narrative="This is Date on or after that search is to be taken" stage="since" />
      <input type="date" name="todate" narrative="This is Date on or before that search is to be taken" stage="before" />
      <input type="text" name="subject" narrative="This is the subject text to be search with" stage="subject" />
      <input type="text" name="body" narrative="This is the body text to be search with" stage="body" />
      <input type="text" name="FolderName" narrative="Folder in which to look for" stage="FolderName" />
    </inputs>
    <onsuccess>d880a731-9a6f-4699-8b9a-cdf049a418cb</onsuccess>
  </stage>
  <stage stageid="cb7db668-4d1d-49dc-9ad0-474e7593686e" name="End" type="End">
    <subsheetid>1430d38d-4e03-47d5-bb8c-c9978ae1aeca</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>330</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="collection" name="UIDs" narrative="list of UID of mails that matched the searched " stage="UIDs" />
    </outputs>
  </stage>
  <stage stageid="0270fb36-91e0-4740-90c0-f22299e80622" name="Send Search UID(s) Request" type="Code">
    <subsheetid>1430d38d-4e03-47d5-bb8c-c9978ae1aeca</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>210</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="from" expr="[from]" />
      <input type="text" name="since" expr="[since(text)]" />
      <input type="text" name="to" expr="[to]" />
      <input type="text" name="before" expr="[before(text)]" />
      <input type="text" name="subject" expr="[subject]" />
      <input type="text" name="body" expr="[body]" />
    </inputs>
    <outputs>
      <output type="collection" name="UIDs" stage="UIDs" />
    </outputs>
    <onsuccess>1d917346-4ef5-4232-89ed-bbb5b5a3fd9e</onsuccess>
    <code><![CDATA[string output;
if (tcpc == null || ssl == null) {
	output = "Connection with Imap Server is not established";
	closeConnection();
	throw new ApplicationException(output);
	}

try {
	string request = "$ UID SEARCH";
	if (from != null && from != String.Empty){
		request += " FROM \"" + from + "\"";
		}

	if (to != null && to != String.Empty){
		request += " TO \"" + to + "\"";
		}

	if (since != null && since != String.Empty){
		request += " SINCE " + since;
		}
		
	if (before != null && before != String.Empty){
		request += " BEFORE " + before;
		}
	
	if (subject != null && subject != String.Empty){
		request += " SUBJECT \"" + subject + "\"";
		}
	if (body != null && body != String.Empty){
		request += " BODY \"" + body + "\"";
		}	
	output = receiveResponse(request + "\r\n");
	if (!output.Contains("$ OK")){
	throw new ApplicationException("failure in search or not logged in or server encountered an error");
	}
	string[] lines = output.Split(new string[]{"\r\n","\n"}, StringSplitOptions.None);
	output = lines[0];
	string[] words = output.Split(new string[]{" ","\t"}, StringSplitOptions.None);
	UIDs = new DataTable(); 
	UIDs.Columns.Add(new DataColumn("UID"));
	for (int i = 2; i < words.Length; i++){
		int myint;
		if( int.TryParse(words[i], out myint)){
			DataRow row = UIDs.NewRow();
			row[0] = words[i];
			UIDs.Rows.Add(row);	
			}		
		}
	}
catch (Exception ex){
	closeConnection();
	throw ex;
	}	


]]></code>
  </stage>
  <stage stageid="95218a8e-fec0-4887-a8a6-ea6637004ec1" name="from" type="Data">
    <subsheetid>1430d38d-4e03-47d5-bb8c-c9978ae1aeca</subsheetid>
    <loginhibit />
    <narrative>Sender's Email ID</narrative>
    <displayx>-330</displayx>
    <displayy>-75</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="71a11c51-ef5a-4029-a385-b4d6ae37ab17" name="since" type="Data">
    <subsheetid>1430d38d-4e03-47d5-bb8c-c9978ae1aeca</subsheetid>
    <loginhibit />
    <narrative>Start Date </narrative>
    <displayx>-330</displayx>
    <displayy>-45</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>date</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="60abaf0b-9cc4-4504-a1c9-815374bf3dc0" name="since(text)" type="Data">
    <subsheetid>1430d38d-4e03-47d5-bb8c-c9978ae1aeca</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-330</displayx>
    <displayy>-15</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="93123e5f-a1ab-4965-b636-14c2d81519df" name="to" type="Data">
    <subsheetid>1430d38d-4e03-47d5-bb8c-c9978ae1aeca</subsheetid>
    <loginhibit />
    <narrative>Recipient's Email ID</narrative>
    <displayx>-255</displayx>
    <displayy>-75</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="72f88996-4980-48ce-8a60-d13c64e5240e" name="before" type="Data">
    <subsheetid>1430d38d-4e03-47d5-bb8c-c9978ae1aeca</subsheetid>
    <loginhibit />
    <narrative>End Date</narrative>
    <displayx>-255</displayx>
    <displayy>-45</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>date</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="071aa1e3-b133-4833-b895-9d9b759f87ee" name="Format Date" type="MultipleCalculation">
    <subsheetid>1430d38d-4e03-47d5-bb8c-c9978ae1aeca</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>150</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>0270fb36-91e0-4740-90c0-f22299e80622</onsuccess>
    <steps>
      <calculation expression="FormatDate([since], &quot;dd-MMM-yyyy&quot;)" stage="since(text)" />
      <calculation expression="FormatDate([before], &quot;dd-MMM-yyyy&quot;)" stage="before(text)" />
    </steps>
  </stage>
  <stage stageid="11698c41-2c0c-4652-9b76-829b1c2cd4da" name="before(text)" type="Data">
    <subsheetid>1430d38d-4e03-47d5-bb8c-c9978ae1aeca</subsheetid>
    <narrative>
    </narrative>
    <displayx>-255</displayx>
    <displayy>-15</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="54e36b80-f630-43fb-ad85-815b19905b01" name="subject" type="Data">
    <subsheetid>1430d38d-4e03-47d5-bb8c-c9978ae1aeca</subsheetid>
    <loginhibit />
    <narrative>Subject Of mail</narrative>
    <displayx>-330</displayx>
    <displayy>15</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f1592c5f-d15f-487a-9f7b-d6e3a433d291" name="body" type="Data">
    <subsheetid>1430d38d-4e03-47d5-bb8c-c9978ae1aeca</subsheetid>
    <loginhibit />
    <narrative>Mail Body</narrative>
    <displayx>-255</displayx>
    <displayy>15</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5d3c49e8-7527-46bf-b9cd-f62ec2b7d1d9" name="UIDs" type="Collection">
    <subsheetid>1430d38d-4e03-47d5-bb8c-c9978ae1aeca</subsheetid>
    <loginhibit />
    <narrative>Collection of unique IDs of Mails</narrative>
    <displayx>-330</displayx>
    <displayy>180</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="920e29b9-39b6-4daa-9667-2e71139015e0" name="Get Message" type="SubSheetInfo">
    <subsheetid>b6f2c71c-22e0-4e6a-b736-6ed78b0c7870</subsheetid>
    <narrative>Gets the whole message along with from to body and subject.</narrative>
    <displayx>-240</displayx>
    <displayy>-150</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="27e38003-c567-4bf8-87f8-fa5744312496" name="Start" type="Start">
    <subsheetid>b6f2c71c-22e0-4e6a-b736-6ed78b0c7870</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>0</displayx>
    <displayy>-90</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="number" name="UID" narrative="Message ID" stage="UID" />
      <input type="text" name="FolderName" narrative=" folder to find message " stage="FolderName" />
    </inputs>
    <onsuccess>419baa07-2e97-4aff-ba23-1fe3d75a36d5</onsuccess>
  </stage>
  <stage stageid="c4fcd0ba-3b2c-4294-b91e-6e0dcadd27c1" name="End" type="End">
    <subsheetid>b6f2c71c-22e0-4e6a-b736-6ed78b0c7870</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>0</displayx>
    <displayy>180</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="collection" name="Message" narrative="Whole Contents of Message." stage="Message" />
    </outputs>
  </stage>
  <stage stageid="406d41c5-0eb4-4f6d-a5da-8eedccf81207" name="Get Message" type="Code">
    <subsheetid>b6f2c71c-22e0-4e6a-b736-6ed78b0c7870</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>0</displayx>
    <displayy>90</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="UID" expr="[UID]" />
    </inputs>
    <outputs>
      <output type="collection" name="message" stage="Message" />
    </outputs>
    <onsuccess>13e0d01c-2767-477f-9fff-f3a6e3327b4b</onsuccess>
    <code><![CDATA[message = new DataTable();
message.Columns.Add(new DataColumn("From"));
message.Columns.Add(new DataColumn("To"));
message.Columns.Add(new DataColumn("Date"));
message.Columns.Add(new DataColumn("Subject"));
message.Columns.Add(new DataColumn("Body"));
string body,from,to,subject,date;
body=from=to=subject=date=null;
string output = receiveResponse("$ UID FETCH " + UID + " (BODY[HEADER.FIELDS (FROM TO SUBJECT DATE)])\r\n");
string[] lines = output.Split(new string[]{"\r\n","\n"}, StringSplitOptions.None);

for(int i = 0; i < lines.Length; i++){
	if(lines[i].Contains("From: ")){
		from = lines[i];
		}
	else if(lines[i].Contains("To: ")){
		to = lines[i];
		}
	else if(lines[i].Contains("Date: ")){
		date = lines[i];
		}
	else if(lines[i].Contains("Subject: ")){
			do{
				subject += lines[i++];
			}while(lines[i].StartsWith(" "));
			i-=1;
		}
}

if(from != null){
	from = Regex.Match(from, @"\w*\.*\w*@\w*.com").Groups[0].Value;
}
if(to != null){
	to = Regex.Match(to, @"\w*\.*\w*@\w*.com").Groups[0].Value;
}
if(date != null){
	date = Regex.Match(date, @"(?<=Date: ).*").Groups[0].Value;
}
if(subject != null){
	subject = Regex.Match(subject, @"Subject: (.*)").Groups[1].Value;
}
string attachments = receiveResponse("$ UID FETCH " + UID + " BODYSTRUCTURE\r\n");
attachments = Regex.Match(attachments,@"\([^()]+\([^)]+\)[^(]+\([^(]+\([^)]+\)\)[^)]+\)").Groups[0].Value;
if(string.IsNullOrEmpty(attachments)){
	output = receiveResponse("$ UID FETCH " + UID.ToString() + " BODY[1]\r\n");
}else{
	output = receiveResponse("$ UID FETCH " + UID.ToString() + " BODY[1.1]\r\n");
}
lines = output.Split(new string[]{"\r\n","\n"},StringSplitOptions.None);
StringBuilder text = new StringBuilder();
for( int i = 1; i < lines.Length - 1; i++){
	if((!lines[i].Contains("$ OK")) && (!lines[i].Contains("BODY"))){
		text.Append(lines[i]).Append("\n");
	}
}
body = text.ToString();
//Remove unwanted trailing ')' char from the parsed body
body=body.Remove(body.Length-2,1);
//Add them to Message Collection
DataRow row = message.NewRow();
row[0] = from;
row[1] = to;
row[2] = date;
row[3] = subject;
row[4] = body;
message.Rows.Add(row);]]></code>
  </stage>
  <stage stageid="a19a1696-6011-42be-9f90-ba1c398501ba" name="Save Attachments" type="SubSheetInfo">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <narrative>Saves Mail attachments to specified Directory Path</narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="7334a82e-44d0-4d43-9e35-87b2ba29a99a" name="Start" type="Start">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>0</displayx>
    <displayy>-135</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="UID" stage="UID" />
      <input type="text" name="FolderName" stage="FolderName" />
      <input type="text" name="Path" stage="Path" />
    </inputs>
    <onsuccess>470e701b-5e94-477e-9ba0-19c063429407</onsuccess>
  </stage>
  <stage stageid="ff111224-dd50-48fd-82e3-aa8b61c2bf5f" name="End" type="End">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>330</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="collection" name="Attachments" stage="Attachments" />
    </outputs>
  </stage>
  <stage stageid="c1a69f82-514d-4a2c-b996-68afbe54a3ea" name="UID" type="Data">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <narrative>Unique ID of mail</narrative>
    <displayx>-165</displayx>
    <displayy>15</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="0678ff9c-2eae-4900-a2b6-a7207bf7cd2e" name="Attachments" type="Collection">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <narrative>Names of all attachments present in respective mail.</narrative>
    <displayx>45</displayx>
    <displayy>45</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="22d5aa79-be4f-4416-ab0f-2da714d1c39d" name="index" type="Data">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-240</displayx>
    <displayy>60</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue>2</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6e7f56f4-24e8-4696-ab42-df81e83657fc" name="RowCounts" type="Data">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <narrative>Count Of Mail attachments</narrative>
    <displayx>-165</displayx>
    <displayy>60</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="ebda0b99-e1d9-405f-b48c-3ed0170a1e2d" name="filepath" type="Data">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <loginhibit />
    <narrative>Path of the attachment being saved</narrative>
    <displayx>-255</displayx>
    <displayy>105</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a94f655e-8711-4280-8d6c-9118d6981aaa" name="fileEncoding" type="Data">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <narrative>
    </narrative>
    <displayx>-165</displayx>
    <displayy>105</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="49ce214c-de1b-4caf-b580-f313cb678e8d" name="Message" type="Collection">
    <subsheetid>b6f2c71c-22e0-4e6a-b736-6ed78b0c7870</subsheetid>
    <loginhibit />
    <narrative>Mail Details</narrative>
    <displayx>-225</displayx>
    <displayy>90</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="From" type="text" description="Sender of Mail." />
      <field name="To" type="text" description="Receiver of Mail." />
      <field name="Date" type="text" description="Date and Time when mail is received." />
      <field name="Subject" type="text" description="Subject of Mail." />
      <field name="Body" type="text" description="Content of Body of Mail." />
    </collectioninfo>
  </stage>
  <stage stageid="ef17391f-029b-48d7-a269-df0ae443b783" name="UID" type="Data">
    <subsheetid>b6f2c71c-22e0-4e6a-b736-6ed78b0c7870</subsheetid>
    <narrative>Unique ID of mail to access mail</narrative>
    <displayx>-165</displayx>
    <displayy>-15</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9ca46893-7b1e-4fff-ae02-45bd23093386" name="Username" type="Data">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>Mail ID</narrative>
    <displayx>-360</displayx>
    <displayy>-90</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="1243431c-e44b-4231-a8d0-3d7b113154b3" name="Password" type="Data">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>Mail Password</narrative>
    <displayx>-285</displayx>
    <displayy>-90</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>password</datatype>
    <initialvalueenc>
    </initialvalueenc>
    <alwaysinit />
  </stage>
  <stage stageid="4c222b6d-9956-404e-bb4b-4843b268aade" name="Connect IMAP" type="SubSheetInfo">
    <subsheetid>a07911cf-dcf6-46b7-9f4b-821156df7559</subsheetid>
    <narrative>Creates a new connection with IMAP server</narrative>
    <displayx>-195</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="224b6fae-85a6-4a2c-bae6-63cf589598bd" name="Start" type="Start">
    <subsheetid>a07911cf-dcf6-46b7-9f4b-821156df7559</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>ba640ef2-d25e-41a1-b781-a51756bc73c5</onsuccess>
  </stage>
  <stage stageid="40448c02-d699-45a2-aa84-ae81ceabde4a" name="End" type="End">
    <subsheetid>a07911cf-dcf6-46b7-9f4b-821156df7559</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>195</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="e70d144d-8745-40cf-8a92-37f8187714bd" name="Send Connection Request" type="Code">
    <subsheetid>a07911cf-dcf6-46b7-9f4b-821156df7559</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>75</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="host" expr="[IMAP host]" />
      <input type="number" name="port" expr="[IMAP port]" />
    </inputs>
    <outputs>
      <output type="flag" name="connected" stage="connected" />
      <output type="text" name="output" stage="output" />
    </outputs>
    <onsuccess>af9feec7-fff3-4158-8613-b0b33b2864d6</onsuccess>
    <code><![CDATA[try {
	tcpc = new TcpClient(host,Decimal.ToInt32(port));
	ssl = new SslStream(tcpc.GetStream());
	ssl.AuthenticateAsClient(host);
	connected = tcpc.Connected;
	receiveResponse("");
	output = "Connection Establish Sucessfully";
}
catch (Exception ex) {
	connected = false;
	output = ex.Message;	
	closeConnection();
	}
	]]></code>
  </stage>
  <stage stageid="ceecb1e1-c853-4727-9159-05803d01222a" name="Set Configured " type="Calculation">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>30</displayx>
    <displayy>330</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>6db0f2a6-246c-4ff8-813e-a12c52654fa3</onsuccess>
    <calculation expression="True" stage="Configured" />
  </stage>
  <stage stageid="9d09efd5-e694-4911-aa80-c8cc0c640a39" name="Configured" type="Data">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-285</displayx>
    <displayy>0</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="060cb1c1-db98-4e69-acdb-af0cfac39004" name="connected" type="Data">
    <subsheetid>a07911cf-dcf6-46b7-9f4b-821156df7559</subsheetid>
    <narrative>
    </narrative>
    <displayx>-180</displayx>
    <displayy>15</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue>False</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="ba640ef2-d25e-41a1-b781-a51756bc73c5" name="Configured?" type="Decision">
    <subsheetid>a07911cf-dcf6-46b7-9f4b-821156df7559</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>60</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <decision expression="[Configured]" />
    <ontrue>e70d144d-8745-40cf-8a92-37f8187714bd</ontrue>
    <onfalse>8a768676-48dd-4e60-9c90-59c1726ddc8f</onfalse>
  </stage>
  <stage stageid="8a768676-48dd-4e60-9c90-59c1726ddc8f" name="System Exception" type="Exception">
    <subsheetid>a07911cf-dcf6-46b7-9f4b-821156df7559</subsheetid>
    <narrative>
    </narrative>
    <displayx>105</displayx>
    <displayy>-15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <exception type="System Exception" detail="&quot;Server not Configured!&quot;" />
  </stage>
  <stage stageid="5d598b48-7ef9-4061-927b-d53797d2ae6d" name="output" type="Data">
    <subsheetid>a07911cf-dcf6-46b7-9f4b-821156df7559</subsheetid>
    <narrative>
    </narrative>
    <displayx>-255</displayx>
    <displayy>15</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="2c6d6eb8-9da5-45e6-8e95-85b8237b7e94" name="Connect IMAP" type="SubSheet">
    <subsheetid>dab928dd-5fd3-48ef-9756-4d64792ab888</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-135</displayx>
    <displayy>-60</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>77c9daa3-9e87-4275-bbe0-63d354c8ff1c</onsuccess>
    <processid>a07911cf-dcf6-46b7-9f4b-821156df7559</processid>
  </stage>
  <stage stageid="cd316921-c1b3-4b90-8ec0-d81eb338f71c" name="Close Connection" type="SubSheet">
    <subsheetid>c227143e-75fe-4016-b5a7-7d6cfe85443f</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-15</displayx>
    <displayy>-15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>9d833591-234d-4b07-8cc9-ffa216c48fe5</onsuccess>
    <processid>7749f7db-1505-4566-8fc6-f99f4a78515d</processid>
  </stage>
  <stage stageid="419baa07-2e97-4aff-ba23-1fe3d75a36d5" name="Connect IMAP" type="SubSheet">
    <subsheetid>b6f2c71c-22e0-4e6a-b736-6ed78b0c7870</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>0</displayx>
    <displayy>-45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>2ea56832-435f-4a40-a94f-581a6ec2de50</onsuccess>
    <processid>a07911cf-dcf6-46b7-9f4b-821156df7559</processid>
  </stage>
  <stage stageid="2ea56832-435f-4a40-a94f-581a6ec2de50" name="Login" type="SubSheet">
    <subsheetid>b6f2c71c-22e0-4e6a-b736-6ed78b0c7870</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>0</displayx>
    <displayy>0</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>8340d727-125b-4d2b-b027-fa40f1c0e98b</onsuccess>
    <processid>dab928dd-5fd3-48ef-9756-4d64792ab888</processid>
  </stage>
  <stage stageid="8340d727-125b-4d2b-b027-fa40f1c0e98b" name="Select Folder" type="SubSheet">
    <subsheetid>b6f2c71c-22e0-4e6a-b736-6ed78b0c7870</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>0</displayx>
    <displayy>45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="foldername" narrative="This is folder name to select" expr="[FolderName]" />
    </inputs>
    <onsuccess>406d41c5-0eb4-4f6d-a5da-8eedccf81207</onsuccess>
    <processid>572ab18e-33ed-4088-b341-0c8fc5ec05a7</processid>
  </stage>
  <stage stageid="13e0d01c-2767-477f-9fff-f3a6e3327b4b" name="Logout" type="SubSheet">
    <subsheetid>b6f2c71c-22e0-4e6a-b736-6ed78b0c7870</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>0</displayx>
    <displayy>135</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>c4fcd0ba-3b2c-4294-b91e-6e0dcadd27c1</onsuccess>
    <processid>c227143e-75fe-4016-b5a7-7d6cfe85443f</processid>
  </stage>
  <stage stageid="b1bf0fef-911f-4cb0-ad24-2bd7cb404768" name="FolderName" type="Data">
    <subsheetid>b6f2c71c-22e0-4e6a-b736-6ed78b0c7870</subsheetid>
    <narrative>Name of folder where Mail is present</narrative>
    <displayx>-240</displayx>
    <displayy>-15</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d880a731-9a6f-4699-8b9a-cdf049a418cb" name="Connect IMAP" type="SubSheet">
    <subsheetid>1430d38d-4e03-47d5-bb8c-c9978ae1aeca</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>0</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>43de4520-c506-4908-8d94-ec995dfe8e54</onsuccess>
    <processid>a07911cf-dcf6-46b7-9f4b-821156df7559</processid>
  </stage>
  <stage stageid="43de4520-c506-4908-8d94-ec995dfe8e54" name="Login" type="SubSheet">
    <subsheetid>1430d38d-4e03-47d5-bb8c-c9978ae1aeca</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>60</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>49a97e0f-ca3a-4547-a31d-b99422e10b8f</onsuccess>
    <processid>dab928dd-5fd3-48ef-9756-4d64792ab888</processid>
  </stage>
  <stage stageid="49a97e0f-ca3a-4547-a31d-b99422e10b8f" name="Select Folder" type="SubSheet">
    <subsheetid>1430d38d-4e03-47d5-bb8c-c9978ae1aeca</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="foldername" narrative="This is folder name to select" expr="[FolderName]" />
    </inputs>
    <onsuccess>071aa1e3-b133-4833-b895-9d9b759f87ee</onsuccess>
    <processid>572ab18e-33ed-4088-b341-0c8fc5ec05a7</processid>
  </stage>
  <stage stageid="1d917346-4ef5-4232-89ed-bbb5b5a3fd9e" name="Logout" type="SubSheet">
    <subsheetid>1430d38d-4e03-47d5-bb8c-c9978ae1aeca</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>270</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>cb7db668-4d1d-49dc-9ad0-474e7593686e</onsuccess>
    <processid>c227143e-75fe-4016-b5a7-7d6cfe85443f</processid>
  </stage>
  <stage stageid="f8c99fc8-883e-4736-b74a-132271c4d7ab" name="FolderName" type="Data">
    <subsheetid>1430d38d-4e03-47d5-bb8c-c9978ae1aeca</subsheetid>
    <narrative>Name of folder where Mail is present</narrative>
    <displayx>-330</displayx>
    <displayy>60</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="3ac3edc8-e64d-438e-949b-3b2d23eca2b0" name="Send Save Attachment Request" type="Code">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>240</displayx>
    <displayy>-90</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="number" name="UID" expr="[UID]" />
    </inputs>
    <outputs>
      <output type="collection" name="attachments" stage="Attachments" />
    </outputs>
    <onsuccess>e6531fff-cc1b-4837-8012-0900982b739d</onsuccess>
    <code><![CDATA[string str = receiveResponse("$ UID FETCH " + UID + " BODYSTRUCTURE\r\n");
attachments = new DataTable();
attachments.Columns.Add(new DataColumn("Attachment"));
attachments.Columns.Add(new DataColumn("Encoding"));
attachments.Columns.Add(new DataColumn("Filename"));
foreach(Match entry in Regex.Matches(str, @"\([^()]+\([^)]+\)[^(]+\([^(]+\([^)]+\)\)[^)]+\)")){
	 DataRow row = attachments.NewRow();
	 row[0] = entry.Value.ToString();
	 MatchCollection matchList = Regex.Matches(row[0].ToString(), @"\s(?<o>\"")\w+(?<c>\"")\s\d+");
	 row[1] = Regex.Match(row[0].ToString(), @"\s(?<o>\"")\w+(?<c>\"")\s\d+").ToString().Split(new string[]{" "},StringSplitOptions.None)[1].Replace("\"",String.Empty);
	 row[2] = Regex.Match(row[0].ToString(), @"(?<=""FILENAME"" "")[^\/:*""<>|]+\.\w+");
	 attachments.Rows.Add(row);
	}]]></code>
  </stage>
  <stage stageid="ac3677d3-631a-473b-b558-8f5ed587d7e6" name="Save Attachment File(s)" type="Code">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>240</displayx>
    <displayy>210</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="filepath" expr="[filepath]" />
      <input type="number" name="index" expr="[index]" />
      <input type="text" name="UID" expr="[UID]" />
      <input type="text" name="fileEncoding" expr="[fileEncoding]" />
    </inputs>
    <onsuccess>ab647d9c-118b-4f50-bb15-329e63305386</onsuccess>
    <code><![CDATA[try{
	string str = receiveResponse("$ UID FETCH " + UID + " BODY[" + index + "]\r\n");
	string base64String = Regex.Match(str,@"(?:\n)\s*([^$]+)").Groups[1].Value;
	string[] lines = base64String.Split(new string[]{"\r\n","\n"}, StringSplitOptions.None);
	string base64Str = "";
	foreach( string line in lines){
		 base64Str += line;
		}
	base64Str = base64Str.Remove(base64Str.Length - 1,1);	
	byte[] bytes = Convert.FromBase64String(base64Str);
	if (File.Exists(filepath)){
		File.Delete(filepath);
		}
	if(bytes != null){
			using (FileStream fs = File.Create(filepath)){
			fs.Write(bytes, 0, bytes.Length);
			}
		}
	}
catch(Exception ex){
	throw new ApplicationException(ex.Message);
	}]]></code>
  </stage>
  <stage stageid="0781a6e7-5029-47cd-99da-4ed5ea2926d4" name="Loop Attachements" type="LoopStart">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>240</displayx>
    <displayy>90</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>120e901c-e43f-45ab-9b48-6dfaed9a9bfb</onsuccess>
    <groupid>e039bf86-394c-411b-abe2-7a87c9d401f6</groupid>
    <looptype>ForEach</looptype>
    <loopdata>Attachments</loopdata>
  </stage>
  <stage stageid="2aedf9fb-55eb-4391-b766-d578cabf16c9" name="Loop Attachements" type="LoopEnd">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>240</displayx>
    <displayy>330</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>8348a4dc-fe85-480f-895e-761865706145</onsuccess>
    <groupid>e039bf86-394c-411b-abe2-7a87c9d401f6</groupid>
  </stage>
  <stage stageid="e6531fff-cc1b-4837-8012-0900982b739d" name="Count Rows" type="Action">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>240</displayx>
    <displayy>-30</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Attachments&quot;" />
    </inputs>
    <outputs>
      <output type="number" name="Count" narrative="The number of rows counted in the collection" stage="RowCounts" />
    </outputs>
    <onsuccess>470f7ba9-d779-4894-97d5-cf82bdec2850</onsuccess>
    <resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Count Rows" />
  </stage>
  <stage stageid="470f7ba9-d779-4894-97d5-cf82bdec2850" name="is Attachment Present?" type="Decision">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>240</displayx>
    <displayy>30</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <decision expression="[RowCounts] &gt; 0" />
    <ontrue>0781a6e7-5029-47cd-99da-4ed5ea2926d4</ontrue>
    <onfalse>8d4becd3-4ea2-4b83-8f1e-2c90cbefb214</onfalse>
  </stage>
  <stage stageid="8d4becd3-4ea2-4b83-8f1e-2c90cbefb214" name="End1" type="End">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>375</displayx>
    <displayy>30</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="collection" name="Attachments" stage="Attachments" />
    </outputs>
  </stage>
  <stage stageid="120e901c-e43f-45ab-9b48-6dfaed9a9bfb" name="Get File Details" type="MultipleCalculation">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>240</displayx>
    <displayy>150</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>ac3677d3-631a-473b-b558-8f5ed587d7e6</onsuccess>
    <steps>
      <calculation expression="[Path] &amp; [Attachments.Filename]" stage="filepath" />
      <calculation expression="[Attachments.Encoding]" stage="fileEncoding" />
    </steps>
  </stage>
  <stage stageid="ab647d9c-118b-4f50-bb15-329e63305386" name="Increment Index" type="Calculation">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>240</displayx>
    <displayy>270</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>2aedf9fb-55eb-4391-b766-d578cabf16c9</onsuccess>
    <calculation expression="[index] + 1" stage="index" />
  </stage>
  <stage stageid="470e701b-5e94-477e-9ba0-19c063429407" name="Connect IMAP" type="SubSheet">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>0</displayx>
    <displayy>-90</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>257423fa-bdad-4b1d-829e-fdb62dadee92</onsuccess>
    <processid>a07911cf-dcf6-46b7-9f4b-821156df7559</processid>
  </stage>
  <stage stageid="257423fa-bdad-4b1d-829e-fdb62dadee92" name="Login" type="SubSheet">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>75</displayx>
    <displayy>-90</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>2a31a37d-57e3-4b80-b161-3fc1d17f9dda</onsuccess>
    <processid>dab928dd-5fd3-48ef-9756-4d64792ab888</processid>
  </stage>
  <stage stageid="2a31a37d-57e3-4b80-b161-3fc1d17f9dda" name="Select Folder" type="SubSheet">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>165</displayx>
    <displayy>-90</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="foldername" narrative="This is folder name to select" expr="[FolderName]" />
    </inputs>
    <onsuccess>3ac3edc8-e64d-438e-949b-3b2d23eca2b0</onsuccess>
    <processid>572ab18e-33ed-4088-b341-0c8fc5ec05a7</processid>
  </stage>
  <stage stageid="8348a4dc-fe85-480f-895e-761865706145" name="Logout" type="SubSheet">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>120</displayx>
    <displayy>330</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>ff111224-dd50-48fd-82e3-aa8b61c2bf5f</onsuccess>
    <processid>c227143e-75fe-4016-b5a7-7d6cfe85443f</processid>
  </stage>
  <stage stageid="a4701ce5-8a63-4525-8784-ab70aacefb5f" name="FolderName" type="Data">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <narrative>Name of folder from where mail is accessed.</narrative>
    <displayx>-240</displayx>
    <displayy>15</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e5ae4fab-2d2f-4ebd-80a3-56fc5e2bc23d" name="Path" type="Data">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <narrative>Directory path where attachments will be saved.</narrative>
    <displayx>-255</displayx>
    <displayy>150</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="af9feec7-fff3-4158-8613-b0b33b2864d6" name="Set Connected" type="Calculation">
    <subsheetid>a07911cf-dcf6-46b7-9f4b-821156df7559</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>135</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>40448c02-d699-45a2-aa84-ae81ceabde4a</onsuccess>
    <calculation expression="True" stage="connected" />
  </stage>
  <stage stageid="d90562d7-cf2f-413f-92bc-3e58acbd67b0" name="Delete Message" type="SubSheetInfo">
    <subsheetid>d4cd3b12-b1d4-4a7b-937b-f9e32b099fb3</subsheetid>
    <narrative>Deletes the mail from IMAP server</narrative>
    <displayx>-300</displayx>
    <displayy>-255</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="a1c3345b-404e-432a-acba-329632d2a4dd" name="Start" type="Start">
    <subsheetid>d4cd3b12-b1d4-4a7b-937b-f9e32b099fb3</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-165</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="number" name="UID" narrative="Message ID" stage="UID" />
      <input type="text" name="FolderName" narrative="Folder where message to be found" stage="FolderName" />
    </inputs>
    <onsuccess>f777a2da-1877-4bd8-a729-d05622726217</onsuccess>
  </stage>
  <stage stageid="fa7313f2-2a40-43e8-a707-3e7be9680f90" name="End" type="End">
    <subsheetid>d4cd3b12-b1d4-4a7b-937b-f9e32b099fb3</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>150</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="0a6136e8-687c-4e43-aaf6-05c3e6be2682" name="Delete Message" type="Code">
    <subsheetid>d4cd3b12-b1d4-4a7b-937b-f9e32b099fb3</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>60</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="UID" expr="[UID]" />
    </inputs>
    <onsuccess>af817f71-3404-4ea2-bbd2-bc0c17899fc3</onsuccess>
    <code><![CDATA[string flagMessage = receiveResponse("$ UID STORE "+UID+" +FLAGS (\\Deleted)\r\n");
string output=null;
if(flagMessage.Contains("$ OK")){
	output = receiveResponse("$ UID EXPUNGE "+UID+"\r\n");
	if(!output.Contains("$ OK")){
		throw new Exception("Unable to delete Message\n"+output);
	}
}else{
	throw new Exception("Unable to flag the Message for deletion.\n"+flagMessage);
}]]></code>
  </stage>
  <stage stageid="f777a2da-1877-4bd8-a729-d05622726217" name="Connect IMAP" type="SubSheet">
    <subsheetid>d4cd3b12-b1d4-4a7b-937b-f9e32b099fb3</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-90</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>87fcb8d8-84ac-4ed6-90d2-cab0a3d5fcd9</onsuccess>
    <processid>a07911cf-dcf6-46b7-9f4b-821156df7559</processid>
  </stage>
  <stage stageid="87fcb8d8-84ac-4ed6-90d2-cab0a3d5fcd9" name="Login" type="SubSheet">
    <subsheetid>d4cd3b12-b1d4-4a7b-937b-f9e32b099fb3</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>06049735-09db-4cb9-94f2-0ec3c1621311</onsuccess>
    <processid>dab928dd-5fd3-48ef-9756-4d64792ab888</processid>
  </stage>
  <stage stageid="06049735-09db-4cb9-94f2-0ec3c1621311" name="Select Folder" type="SubSheet">
    <subsheetid>d4cd3b12-b1d4-4a7b-937b-f9e32b099fb3</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>0</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="foldername" narrative="This is folder name to select" expr="[FolderName]" />
    </inputs>
    <onsuccess>0a6136e8-687c-4e43-aaf6-05c3e6be2682</onsuccess>
    <processid>572ab18e-33ed-4088-b341-0c8fc5ec05a7</processid>
  </stage>
  <stage stageid="af817f71-3404-4ea2-bbd2-bc0c17899fc3" name="Logout" type="SubSheet">
    <subsheetid>d4cd3b12-b1d4-4a7b-937b-f9e32b099fb3</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>fa7313f2-2a40-43e8-a707-3e7be9680f90</onsuccess>
    <processid>c227143e-75fe-4016-b5a7-7d6cfe85443f</processid>
  </stage>
  <stage stageid="7cec5d82-b261-45eb-8068-54c9c6638258" name="Connected?" type="Decision">
    <subsheetid>dab928dd-5fd3-48ef-9756-4d64792ab888</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-15</displayx>
    <displayy>-60</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>60</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <decision expression="[connected]" />
    <ontrue>26803d3c-cfb2-4649-923b-f552a60f5023</ontrue>
    <onfalse>2c6d6eb8-9da5-45e6-8e95-85b8237b7e94</onfalse>
  </stage>
  <stage stageid="77c9daa3-9e87-4275-bbe0-63d354c8ff1c" name="Anchor1" type="Anchor">
    <subsheetid>dab928dd-5fd3-48ef-9756-4d64792ab888</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-135</displayx>
    <displayy>45</displayy>
    <displaywidth>10</displaywidth>
    <displayheight>10</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>26803d3c-cfb2-4649-923b-f552a60f5023</onsuccess>
  </stage>
  <stage stageid="60525981-8456-441a-a5a2-d9b25210ba2d" name="UID" type="Data">
    <subsheetid>d4cd3b12-b1d4-4a7b-937b-f9e32b099fb3</subsheetid>
    <narrative>Unique ID of mail to access mail</narrative>
    <displayx>-315</displayx>
    <displayy>-150</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="cd721fb3-9d09-43b6-a20f-05b5d39e45c6" name="FolderName" type="Data">
    <subsheetid>d4cd3b12-b1d4-4a7b-937b-f9e32b099fb3</subsheetid>
    <narrative>Name of folder where Mail is present</narrative>
    <displayx>-240</displayx>
    <displayy>-150</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="843655a9-0e83-4137-bb3e-0bf75b335273" name="Send Message" type="SubSheetInfo">
    <subsheetid>aca4df97-d2e0-4cfe-9a50-a8628baf8707</subsheetid>
    <narrative>Send Message using SMTP Protocol</narrative>
    <displayx>-360</displayx>
    <displayy>-195</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="3ae887e3-fc81-477e-9f54-c949205faba1" name="Start" type="Start">
    <subsheetid>aca4df97-d2e0-4cfe-9a50-a8628baf8707</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-150</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="To" narrative="Receipent Email Address" stage="To" />
      <input type="text" name="Subject" narrative="Subject for the Message" stage="Subject" />
      <input type="text" name="Body" narrative="Body of the Message" stage="Body" />
      <input type="collection" name="Attachments" narrative="Attachments Path if any" stage="Attachments" />
    </inputs>
    <onsuccess>6cd2f0cd-8ba8-4d0a-ac55-63120d11bcc0</onsuccess>
  </stage>
  <stage stageid="d126c08a-2ada-4924-99d7-38dd2927788d" name="End" type="End">
    <subsheetid>aca4df97-d2e0-4cfe-9a50-a8628baf8707</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>240</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="3bb683b2-a757-4dd9-a0ea-b47fa936caf4" name="Send Message" type="Code">
    <subsheetid>aca4df97-d2e0-4cfe-9a50-a8628baf8707</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="SMTP Host" expr="[SMTP Host]" />
      <input type="number" name="SMTP Port" expr="[SMTP port]" />
      <input type="text" name="Username" expr="[Username]" />
      <input type="password" name="Password" expr="[Password]" />
      <input type="text" name="To" expr="[To]" />
      <input type="collection" name="attachment" expr="[Attachments]" />
      <input type="text" name="Subject" expr="[Subject]" />
      <input type="text" name="Body" expr="[Body]" />
      <input type="flag" name="Enable SSL" expr="[Enable SSL]" />
    </inputs>
    <onsuccess>bbe87838-407a-48d3-b46a-be8428c903e5</onsuccess>
    <code><![CDATA[try {
	SmtpClient smtpserver = new SmtpClient(SMTP_Host,Decimal.ToInt32(SMTP_Port));
	MailMessage mail = new MailMessage();
	mail.From = new MailAddress(Username);
	mail.To.Add(To);
	mail.Subject = Subject;
	mail.Body = Body;
		
	smtpserver.UseDefaultCredentials = false;

	System.Net.Mail.Attachment attachmentObj;
	if(attachment.Rows != null){
		foreach(DataRow row in attachment.Rows){
			foreach(DataColumn column in attachment.Columns){
				attachmentObj = new System.Net.Mail.Attachment(row[column].ToString());
				mail.Attachments.Add(attachmentObj);
			}
		}
	}

	smtpserver.Credentials = new System.Net.NetworkCredential(Username,Password);
	smtpserver.EnableSsl = Enable_SSL;
	smtpserver.Send(mail);
}catch(Exception e){
	throw new Exception(e.Message);
}]]></code>
  </stage>
  <stage stageid="9b71fc61-0e54-4c5f-b717-2d2cc1534e97" name="SMTP Host" type="Data">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>Domain name of SMTP server</narrative>
    <displayx>-360</displayx>
    <displayy>-45</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="2fefba1a-948f-4f8d-9dc9-717ac72fa510" name="SMTP port" type="Data">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>Port number of SMTP server</narrative>
    <displayx>-285</displayx>
    <displayy>-45</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>number</datatype>
    <initialvalue />
    <alwaysinit />
  </stage>
  <stage stageid="470b2423-b0c5-4646-b06d-65ff5680a10e" name="To" type="Data">
    <subsheetid>aca4df97-d2e0-4cfe-9a50-a8628baf8707</subsheetid>
    <narrative>Recepient of mail</narrative>
    <displayx>-285</displayx>
    <displayy>-15</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="71a1f45f-0d47-4483-993c-11132829a24a" name="Subject" type="Data">
    <subsheetid>aca4df97-d2e0-4cfe-9a50-a8628baf8707</subsheetid>
    <narrative>Subject of mail which is to be sent.</narrative>
    <displayx>-360</displayx>
    <displayy>-60</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f18c5705-dcaa-464f-a74b-fc3aba29264e" name="Body" type="Data">
    <subsheetid>aca4df97-d2e0-4cfe-9a50-a8628baf8707</subsheetid>
    <narrative>Mail Body</narrative>
    <displayx>-270</displayx>
    <displayy>-60</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="962f19e4-bff5-4bb8-b33b-671e1318e7f2" name="Attachments" type="Collection">
    <subsheetid>aca4df97-d2e0-4cfe-9a50-a8628baf8707</subsheetid>
    <narrative>Contains FilePath of Attachments to be sent with mail</narrative>
    <displayx>-375</displayx>
    <displayy>-15</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6a6f4a2d-9acf-451d-b144-d4a11b1269d0" name="Enable SSL" type="Data">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-375</displayx>
    <displayy>0</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>flag</datatype>
    <initialvalue>True</initialvalue>
    <alwaysinit />
  </stage>
  <stage stageid="ebadad7a-ca38-4099-921d-fc83680c1675" name="Connect IMAP" type="SubSheet">
    <subsheetid>1a2fb845-7510-4def-85a0-41c6825a1870</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-15</displayx>
    <displayy>-75</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>aa9e96a2-bb1b-4161-a693-c88f686422b5</onsuccess>
    <processid>a07911cf-dcf6-46b7-9f4b-821156df7559</processid>
  </stage>
  <stage stageid="aa9e96a2-bb1b-4161-a693-c88f686422b5" name="Login" type="SubSheet">
    <subsheetid>1a2fb845-7510-4def-85a0-41c6825a1870</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-15</displayx>
    <displayy>-15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>743ddc0f-2ae5-40dc-8ff3-17f63acb0f62</onsuccess>
    <processid>dab928dd-5fd3-48ef-9756-4d64792ab888</processid>
  </stage>
  <stage stageid="b9e0fcba-f53a-49c1-a325-aedd634b4768" name="Logout" type="SubSheet">
    <subsheetid>1a2fb845-7510-4def-85a0-41c6825a1870</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-15</displayx>
    <displayy>105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>cec02655-866d-49b4-b6bd-37af244f6def</onsuccess>
    <processid>c227143e-75fe-4016-b5a7-7d6cfe85443f</processid>
  </stage>
  <stage stageid="bdeebd45-62a5-4854-b933-716c07464d17" name="foldersList" type="Collection">
    <subsheetid>1a2fb845-7510-4def-85a0-41c6825a1870</subsheetid>
    <narrative>
    </narrative>
    <displayx>-240</displayx>
    <displayy>-45</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9099a0ff-ef7c-4254-a45a-f75cd8fc79ad" name="Configuration setting" type="Block">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-435</displayx>
    <displayy>-165</displayy>
    <displaywidth>225</displaywidth>
    <displayheight>195</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="76656305-1814-4412-881b-4f466cb7551b" name="Input" type="Block">
    <subsheetid>aca4df97-d2e0-4cfe-9a50-a8628baf8707</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-435</displayx>
    <displayy>-90</displayy>
    <displaywidth>225</displaywidth>
    <displayheight>105</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="8a6140f7-d738-48b0-a71e-3fd9a5c45f49" name="Input" type="Block">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-315</displayx>
    <displayy>-15</displayy>
    <displaywidth>210</displaywidth>
    <displayheight>195</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="33b6ed96-eab4-4bca-aad4-541ac815afcf" name="Input" type="Block">
    <subsheetid>d4cd3b12-b1d4-4a7b-937b-f9e32b099fb3</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-360</displayx>
    <displayy>-180</displayy>
    <displaywidth>180</displaywidth>
    <displayheight>60</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="f3354f87-1448-40d1-83da-1eba65351d0f" name="Input" type="Block">
    <subsheetid>b6f2c71c-22e0-4e6a-b736-6ed78b0c7870</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-300</displayx>
    <displayy>-45</displayy>
    <displaywidth>180</displaywidth>
    <displayheight>60</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="e52a4613-60d4-44e4-ad19-67744a933d68" name="Output" type="Block">
    <subsheetid>b6f2c71c-22e0-4e6a-b736-6ed78b0c7870</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-300</displayx>
    <displayy>60</displayy>
    <displaywidth>165</displaywidth>
    <displayheight>60</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="db9fcfd8-d75a-41de-b28f-d3b97acce43e" name="Input" type="Block">
    <subsheetid>1430d38d-4e03-47d5-bb8c-c9978ae1aeca</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-390</displayx>
    <displayy>-105</displayy>
    <displaywidth>195</displaywidth>
    <displayheight>195</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="623460bf-94ed-4288-bccb-876b38d97a4c" name="Output" type="Block">
    <subsheetid>1430d38d-4e03-47d5-bb8c-c9978ae1aeca</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-390</displayx>
    <displayy>150</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>60</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="debcbc4a-ab22-4f18-9c3e-61f651e48c28" name="Input" type="Block">
    <subsheetid>572ab18e-33ed-4088-b341-0c8fc5ec05a7</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-315</displayx>
    <displayy>-120</displayy>
    <displaywidth>180</displaywidth>
    <displayheight>60</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="736e5073-8ac1-4a39-bcda-112f7ae2eab0" name="Block1" type="Block">
    <subsheetid>1a2fb845-7510-4def-85a0-41c6825a1870</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-300</displayx>
    <displayy>-75</displayy>
    <displaywidth>135</displaywidth>
    <displayheight>60</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="0d563ab0-2403-4e03-9f77-d12c09522796" name="Block3" type="Block">
    <subsheetid>a07911cf-dcf6-46b7-9f4b-821156df7559</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-315</displayx>
    <displayy>-15</displayy>
    <displaywidth>195</displaywidth>
    <displayheight>60</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="36cc9039-c5a8-454e-8bcb-8e8ca914c826" name="Output" type="Block">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-30</displayx>
    <displayy>15</displayy>
    <displaywidth>165</displaywidth>
    <displayheight>60</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="50eebaca-8d85-453b-8a6d-f1bde4986bbe" name="Note3" type="Note">
    <subsheetid>b9ee1718-8bde-4e00-bceb-a19b5ed2be71</subsheetid>
    <loginhibit />
    <narrative>Save attachments one by one</narrative>
    <displayx>45</displayx>
    <displayy>210</displayy>
    <displaywidth>180</displaywidth>
    <displayheight>60</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="FF0000" />
    <onsuccess>ac3677d3-631a-473b-b558-8f5ed587d7e6</onsuccess>
  </stage>
  <stage stageid="94cd0249-6663-4552-b7a1-91b4e48aa08a" name="Is IMAP host Valid?" type="Decision">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>30</displayx>
    <displayy>-105</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <decision expression="Trim([IMAP host])=&quot;&quot;" />
    <ontrue>1927eea2-f74a-4ec9-8188-0eeaaa43aca5</ontrue>
    <onfalse>4adb8e5e-eedd-4ba4-a173-67de05e0a0be</onfalse>
  </stage>
  <stage stageid="2d1b25f9-ae40-46fb-b53d-a5a984aaa9c6" name="Exception Message" type="Data">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-345</displayx>
    <displayy>105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="1927eea2-f74a-4ec9-8188-0eeaaa43aca5" name="Append Missing field " type="Calculation">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>180</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>4adb8e5e-eedd-4ba4-a173-67de05e0a0be</onsuccess>
    <calculation expression="[Exception Message]&amp;&quot;IMAP host, &quot;" stage="Exception Message" />
  </stage>
  <stage stageid="4adb8e5e-eedd-4ba4-a173-67de05e0a0be" name="Is IMAP port Valid?" type="Decision">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>30</displayx>
    <displayy>-45</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <decision expression="Trim([IMAP port])=&quot;&quot; OR IsNumber([IMAP port])=False" />
    <ontrue>7f82598d-c8eb-4cf3-a603-f768d6b07f06</ontrue>
    <onfalse>d8146430-dee1-4469-b824-9a78afb73a7a</onfalse>
  </stage>
  <stage stageid="d8146430-dee1-4469-b824-9a78afb73a7a" name="Is SMTP host Valid?" type="Decision">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>30</displayx>
    <displayy>15</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <decision expression="Trim([SMTP Host])=&quot;&quot;" />
    <ontrue>b823dcc3-03e3-40eb-ab1a-1f2aeb24c51d</ontrue>
    <onfalse>b7cb152f-e9a1-42db-9dc8-ff43fe211074</onfalse>
  </stage>
  <stage stageid="b7cb152f-e9a1-42db-9dc8-ff43fe211074" name="Is SMTP port Valid?" type="Decision">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>30</displayx>
    <displayy>75</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <decision expression="Trim([SMTP port])=&quot;&quot; OR IsNumber([SMTP port])=False" />
    <ontrue>8f6de7af-b84b-4050-9ad7-aa06a572381c</ontrue>
    <onfalse>30ba011c-2e19-4c86-a5a9-a57b353cf849</onfalse>
  </stage>
  <stage stageid="30ba011c-2e19-4c86-a5a9-a57b353cf849" name="Is Username Valid?" type="Decision">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>30</displayx>
    <displayy>135</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <decision expression="Trim([Username])=&quot;&quot;" />
    <ontrue>5b3a5e69-70f4-4d8c-8340-8c35c6ffbe9e</ontrue>
    <onfalse>7fcbe40b-f042-4086-b33e-3d3ba43d6072</onfalse>
  </stage>
  <stage stageid="7fcbe40b-f042-4086-b33e-3d3ba43d6072" name="Is Password Valid?" type="Decision">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>30</displayx>
    <displayy>195</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <decision expression="Trim([Password])=&quot;&quot;" />
    <ontrue>8f0992ef-3f8b-4edc-b031-88b013bd7a7c</ontrue>
    <onfalse>b5e5b46e-ae4d-4328-a259-142d9d7c9596</onfalse>
  </stage>
  <stage stageid="7f82598d-c8eb-4cf3-a603-f768d6b07f06" name="Append Missing field" type="Calculation">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>180</displayx>
    <displayy>-45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>d8146430-dee1-4469-b824-9a78afb73a7a</onsuccess>
    <calculation expression="[Exception Message]&amp;&quot;IMAP port, &quot;" stage="Exception Message" />
  </stage>
  <stage stageid="b823dcc3-03e3-40eb-ab1a-1f2aeb24c51d" name="Append Missing field" type="Calculation">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>180</displayx>
    <displayy>15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>b7cb152f-e9a1-42db-9dc8-ff43fe211074</onsuccess>
    <calculation expression="[Exception Message]&amp;&quot;SMTP host, &quot;" stage="Exception Message" />
  </stage>
  <stage stageid="8f6de7af-b84b-4050-9ad7-aa06a572381c" name="Append Missing field" type="Calculation">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>180</displayx>
    <displayy>75</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>30ba011c-2e19-4c86-a5a9-a57b353cf849</onsuccess>
    <calculation expression="[Exception Message]&amp;&quot;SMTP port, &quot;" stage="Exception Message" />
  </stage>
  <stage stageid="5b3a5e69-70f4-4d8c-8340-8c35c6ffbe9e" name="Append Missing field" type="Calculation">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>180</displayx>
    <displayy>135</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>7fcbe40b-f042-4086-b33e-3d3ba43d6072</onsuccess>
    <calculation expression="[Exception Message]&amp;&quot;Username, &quot;" stage="Exception Message" />
  </stage>
  <stage stageid="8f0992ef-3f8b-4edc-b031-88b013bd7a7c" name="Append Missing field" type="Calculation">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>180</displayx>
    <displayy>195</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>b5e5b46e-ae4d-4328-a259-142d9d7c9596</onsuccess>
    <calculation expression="[Exception Message]&amp;&quot;Password, &quot;" stage="Exception Message" />
  </stage>
  <stage stageid="b5e5b46e-ae4d-4328-a259-142d9d7c9596" name="Any Configuration Field Missing?" type="Decision">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>30</displayx>
    <displayy>270</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <decision expression="[Exception Message]&lt;&gt;&quot;&quot;" />
    <ontrue>a378c735-656d-4c78-9647-2d95412f1d8f</ontrue>
    <onfalse>ceecb1e1-c853-4727-9159-05803d01222a</onfalse>
  </stage>
  <stage stageid="2d6748c5-b570-47dd-a1f5-c2c1a808d6c3" name="Configuration Exception" type="Exception">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <narrative>
    </narrative>
    <displayx>285</displayx>
    <displayy>270</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <exception type="Business Exception" detail="[Exception Message]" />
  </stage>
  <stage stageid="74772ee7-14c3-4d03-9c55-0288a6f119c4" name="var" type="Block">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-390</displayx>
    <displayy>75</displayy>
    <displaywidth>105</displaywidth>
    <displayheight>60</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="91eb83c0-8598-4f1f-bbff-b71a0a58782c" name="List Messages" type="SubSheetInfo">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <narrative>
    </narrative>
    <displayx>-345</displayx>
    <displayy>-390</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>90</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
  </stage>
  <stage stageid="7018fb1d-de5b-47a7-8fee-7442b8b5b583" name="End" type="End">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>600</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <outputs>
      <output type="collection" name="Messages" narrative="list of UID of mails that matched the searched " stage="Messages" />
    </outputs>
  </stage>
  <stage stageid="f712396d-63b2-44bd-9fca-5e2df386262d" name="Search UID(s)" type="Code">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>150</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="from" expr="[from]" />
      <input type="text" name="since" expr="[since(text)]" />
      <input type="text" name="to" expr="[to]" />
      <input type="text" name="before" expr="[before(text)]" />
      <input type="text" name="subject" expr="[subject]" />
      <input type="text" name="body" expr="[body]" />
    </inputs>
    <outputs>
      <output type="collection" name="UIDs" stage="UIDs" />
    </outputs>
    <onsuccess>d0402cba-18e3-4a5f-bfe2-5f88d37319f6</onsuccess>
    <code><![CDATA[string output;
if (tcpc == null || ssl == null) {
	output = "Connection with Imap Server is not established";
	closeConnection();
	throw new ApplicationException(output);
	}

try {
	string request = "$ UID SEARCH";
	if (from != null && from != String.Empty){
		request += " FROM \"" + from + "\"";
		}

	if (to != null && to != String.Empty){
		request += " TO \"" + to + "\"";
		}

	if (since != null && since != String.Empty){
		request += " SINCE " + since;
		}
		
	if (before != null && before != String.Empty){
		request += " BEFORE " + before;
		}
	
	if (subject != null && subject != String.Empty){
		request += " SUBJECT \"" + subject + "\"";
		}
	if (body != null && body != String.Empty){
		request += " BODY \"" + body + "\"";
		}	
	output = receiveResponse(request + "\r\n");
	if (!output.Contains("$ OK")){
	throw new ApplicationException("failure in search or not logged in or server encountered an error");
	}
	string[] lines = output.Split(new string[]{"\r\n","\n"}, StringSplitOptions.None);
	output = lines[0];
	string[] words = output.Split(new string[]{" ","\t"}, StringSplitOptions.None);
	UIDs = new DataTable(); 
	UIDs.Columns.Add(new DataColumn("UID"));
	for (int i = 2; i < words.Length; i++){
		int myint;
		if( int.TryParse(words[i], out myint)){
			DataRow row = UIDs.NewRow();
			row[0] = words[i];
			UIDs.Rows.Add(row);	
			}		
		}
	}
catch (Exception ex){
	closeConnection();
	throw ex;
	}	


]]></code>
  </stage>
  <stage stageid="979fe81b-a6b5-439b-a283-8beb3baba00a" name="from" type="Data">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>Sender's Email ID</narrative>
    <displayx>-300</displayx>
    <displayy>-285</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="226c254b-fc3d-45c3-bc5d-91ecd92b25de" name="since" type="Data">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>Start Date </narrative>
    <displayx>-300</displayx>
    <displayy>-255</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>date</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="da990c61-d5c6-4cbf-b6d9-51ccbd663c71" name="since(text)" type="Data">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-300</displayx>
    <displayy>-225</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="58562293-ae49-48d2-98c2-01811cde8836" name="to" type="Data">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>Recipient's Email ID</narrative>
    <displayx>-225</displayx>
    <displayy>-285</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="bd7a4f01-27f0-4fc7-adbf-fc0b10579aa3" name="before" type="Data">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>End Date</narrative>
    <displayx>-225</displayx>
    <displayy>-255</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>date</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f28c45e9-572c-46e3-82f4-e4d48a015276" name="before(text)" type="Data">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <narrative>
    </narrative>
    <displayx>-225</displayx>
    <displayy>-225</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d3bc96a9-b808-4bb3-8507-c5098d9f0aee" name="subject" type="Data">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>Subject Of mail</narrative>
    <displayx>-300</displayx>
    <displayy>-195</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="239198c3-25bf-46ef-9480-8fc2b2cb72c5" name="body" type="Data">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>Mail Body</narrative>
    <displayx>-225</displayx>
    <displayy>-195</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e841c0a6-436f-4bfb-bf4c-d81c21da5384" name="UIDs" type="Collection">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>Collection of unique IDs of Mails</narrative>
    <displayx>-345</displayx>
    <displayy>-45</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b3d3a8e0-5fc1-4f65-ba69-86ce7579449d" name="Connect IMAP" type="SubSheet">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-30</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>19d78e16-836a-498b-817c-50c1f59423be</onsuccess>
    <processid>a07911cf-dcf6-46b7-9f4b-821156df7559</processid>
  </stage>
  <stage stageid="19d78e16-836a-498b-817c-50c1f59423be" name="Login" type="SubSheet">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>30</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>7f9a6d5b-1a4f-48e1-980f-331a10e53609</onsuccess>
    <processid>dab928dd-5fd3-48ef-9756-4d64792ab888</processid>
  </stage>
  <stage stageid="7f9a6d5b-1a4f-48e1-980f-331a10e53609" name="Select Folder" type="SubSheet">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>90</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="foldername" narrative="This is folder name to select" expr="[FolderName]" />
    </inputs>
    <onsuccess>f712396d-63b2-44bd-9fca-5e2df386262d</onsuccess>
    <processid>572ab18e-33ed-4088-b341-0c8fc5ec05a7</processid>
  </stage>
  <stage stageid="15c9759a-958f-46a6-845e-3da79e40816b" name="Logout" type="SubSheet">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>525</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>7018fb1d-de5b-47a7-8fee-7442b8b5b583</onsuccess>
    <processid>c227143e-75fe-4016-b5a7-7d6cfe85443f</processid>
  </stage>
  <stage stageid="2f84820c-b5a3-4492-bf19-48342bd423c8" name="FolderName" type="Data">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <narrative>Name of folder where Mail is present</narrative>
    <displayx>-300</displayx>
    <displayy>-150</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="998c4ae5-66b4-485d-8282-05166dba2f49" name="Input" type="Block">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-360</displayx>
    <displayy>-315</displayy>
    <displaywidth>195</displaywidth>
    <displayheight>195</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="68d4500a-407d-4eb7-8b51-7e541a8096b6" name="Output" type="Block">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-405</displayx>
    <displayy>-75</displayy>
    <displaywidth>240</displaywidth>
    <displayheight>105</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="58cf1fb6-64b5-48af-894f-fa256b589351" name="Get Message Headers" type="Code">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>270</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="UID" expr="[UIDs.UID]" />
    </inputs>
    <outputs>
      <output type="collection" name="message" stage="Message Headers" />
    </outputs>
    <onsuccess>77ad4287-26c7-4371-a9d1-e12c6a94065c</onsuccess>
    <code><![CDATA[message = new DataTable();
message.Columns.Add(new DataColumn("From"));
message.Columns.Add(new DataColumn("To"));
message.Columns.Add(new DataColumn("Date"));
message.Columns.Add(new DataColumn("Subject"));
//message.Columns.Add(new DataColumn("Body"));
string body,from,to,subject,date;
body=from=to=subject=date=null;
string output = receiveResponse("$ UID FETCH " + UID + " (BODY[HEADER.FIELDS (FROM TO SUBJECT DATE)])\r\n");
string[] lines = output.Split(new string[]{"\r\n","\n"}, StringSplitOptions.None);

for(int i = 0; i < lines.Length; i++){
	if(lines[i].Contains("From: ")){
		from = lines[i];
		}
	else if(lines[i].Contains("To: ")){
		to = lines[i];
		}
	else if(lines[i].Contains("Date: ")){
		date = lines[i];
		}
	else if(lines[i].Contains("Subject: ")){
			do{
				subject += lines[i++];
			}while(lines[i].StartsWith(" "));
			i-=1;
		}
}

if(from != null){
	from = Regex.Match(from, @"\w*\.*\w*@\w*.com").Groups[0].Value;
}
if(to != null){
	to = Regex.Match(to, @"\w*\.*\w*@\w*.com").Groups[0].Value;
}
if(date != null){
	date = Regex.Match(date, @"(?<=Date: ).*").Groups[0].Value;
}
if(subject != null){
	subject = Regex.Match(subject, @"Subject: (.*)").Groups[1].Value;
}

DataRow row = message.NewRow();
row[0] = from;
row[1] = to;
row[2] = date;
row[3] = subject;
message.Rows.Add(row);]]></code>
  </stage>
  <stage stageid="a4fe483d-5248-4053-b6bf-0724a394edcb" name="Message Headers" type="Collection">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>Mail Details</narrative>
    <displayx>-255</displayx>
    <displayy>-45</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="From" type="text" description="Sender of Mail." />
      <field name="To" type="text" description="Receiver of Mail." />
      <field name="Date" type="text" description="Date and Time when mail is received." />
      <field name="Subject" type="text" description="Subject of Mail." />
    </collectioninfo>
  </stage>
  <stage stageid="d0402cba-18e3-4a5f-bfe2-5f88d37319f6" name="UIDs Loop" type="LoopStart">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>210</displayy>
    <displaywidth>180</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>58cf1fb6-64b5-48af-894f-fa256b589351</onsuccess>
    <groupid>abc2543f-6c25-4db4-8975-243741a7149f</groupid>
    <looptype>ForEach</looptype>
    <loopdata>UIDs</loopdata>
  </stage>
  <stage stageid="a5c45552-c335-450f-bf28-b00c337458a1" name="UIDs Loop" type="LoopEnd">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>465</displayy>
    <displaywidth>180</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>15c9759a-958f-46a6-845e-3da79e40816b</onsuccess>
    <groupid>abc2543f-6c25-4db4-8975-243741a7149f</groupid>
  </stage>
  <stage stageid="296dc51c-83e7-4d54-bafd-987781701b17" name="Messages" type="Collection">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-345</displayx>
    <displayy>0</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="UID" type="text" description="Unique ID of Mail" />
      <field name="From" type="text" description="Sender Of Mail" />
      <field name="To" type="text" description="Recepient Of Mail" />
      <field name="Date" type="text" description="Date and Time of Mail received" />
      <field name="Subject" type="text" description="Subject of Mail" />
    </collectioninfo>
  </stage>
  <stage stageid="03571ad4-e4fb-476f-a4fd-792d7ac91faf" name="Start" type="Start">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-315</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="from" narrative="This is mail ID that sended the mail" stage="from" />
      <input type="text" name="to" narrative="This is Mail ID that received the mail" stage="to" />
      <input type="date" name="fromdate" narrative="This is Date on or after that search is to be taken" stage="since" />
      <input type="date" name="todate" narrative="This is Date on or before that search is to be taken" stage="before" />
      <input type="text" name="subject" narrative="This is the subject text to be search with" stage="subject" />
      <input type="text" name="body" narrative="This is the body text to be search with" stage="body" />
      <input type="text" name="FolderName" narrative="Folder in which to look for" stage="FolderName" />
    </inputs>
    <onsuccess>10d090ed-092a-4187-8cde-20aeef913d3e</onsuccess>
  </stage>
  <stage stageid="77ad4287-26c7-4371-a9d1-e12c6a94065c" name="Add Row" type="Action">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>330</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <inputs>
      <input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Messages&quot;" />
    </inputs>
    <onsuccess>43d4ece1-51f1-461b-a4b0-c4862ce0a33f</onsuccess>
    <resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Add Row" />
  </stage>
  <stage stageid="43d4ece1-51f1-461b-a4b0-c4862ce0a33f" name="Store Values In Collection" type="MultipleCalculation">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>390</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>a5c45552-c335-450f-bf28-b00c337458a1</onsuccess>
    <steps>
      <calculation expression="[UIDs.UID]" stage="Messages.UID" />
      <calculation expression="[Message Headers.From]" stage="Messages.From" />
      <calculation expression="[Message Headers.To]" stage="Messages.To" />
      <calculation expression="[Message Headers.Date]" stage="Messages.Date" />
      <calculation expression="[Message Headers.Subject]" stage="Messages.Subject" />
    </steps>
  </stage>
  <stage stageid="ab7a7bb7-cf4f-4aa7-b5cf-83c1683bc448" name="Is Folder Name Invalid?" type="Decision">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-165</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <decision expression="Trim([FolderName])=&quot;&quot;" />
    <ontrue>93531376-e3ce-42c2-bf36-e2c628458b82</ontrue>
    <onfalse>8cdf5b9a-658d-4129-b00d-a957339bcfd9</onfalse>
  </stage>
  <stage stageid="93531376-e3ce-42c2-bf36-e2c628458b82" name="Business Exception" type="Exception">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <narrative>
    </narrative>
    <displayx>225</displayx>
    <displayy>-165</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <exception type="Business Exception" detail="&quot;Invalid Folder&quot;" />
  </stage>
  <stage stageid="8cdf5b9a-658d-4129-b00d-a957339bcfd9" name="Is Search Parameter Invalid?" type="Decision">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-105</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <decision expression="Trim([from]&amp;[to]&amp;[before(text)]&amp;[since(text)]&amp;[body]&amp;[subject])=&quot;&quot;" />
    <ontrue>70f5f858-468c-4a12-b3f6-203439e95a69</ontrue>
    <onfalse>b3d3a8e0-5fc1-4f65-ba69-86ce7579449d</onfalse>
  </stage>
  <stage stageid="10d090ed-092a-4187-8cde-20aeef913d3e" name="Format Date" type="MultipleCalculation">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-240</displayy>
    <displaywidth>90</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>ab7a7bb7-cf4f-4aa7-b5cf-83c1683bc448</onsuccess>
    <steps>
      <calculation expression="FormatDate([since], &quot;dd-MMM-yyyy&quot;)" stage="since(text)" />
      <calculation expression="FormatDate([before], &quot;dd-MMM-yyyy&quot;)" stage="before(text)" />
    </steps>
  </stage>
  <stage stageid="70f5f858-468c-4a12-b3f6-203439e95a69" name="Business Exception" type="Exception">
    <subsheetid>65c494bc-32bf-4bc0-820f-b2414bae6797</subsheetid>
    <narrative>
    </narrative>
    <displayx>225</displayx>
    <displayy>-105</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <exception type="Business Exception" detail="&quot;Invalid Input for search parameters&quot;" />
  </stage>
  <stage stageid="e38a1b7a-3d0a-4f33-a70a-70f94c9436d7" name="BE-Invalid Credentials" type="Exception">
    <subsheetid>dab928dd-5fd3-48ef-9756-4d64792ab888</subsheetid>
    <narrative>
    </narrative>
    <displayx>255</displayx>
    <displayy>45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <exception type="Business Exception" detail="&quot;Invalid Login Credentials&quot;" />
  </stage>
  <stage stageid="e55d4822-f703-4467-9394-700d6d53139a" name="Recover1" type="Recover">
    <subsheetid>dab928dd-5fd3-48ef-9756-4d64792ab888</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>90</displayx>
    <displayy>45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>e38a1b7a-3d0a-4f33-a70a-70f94c9436d7</onsuccess>
  </stage>
  <stage stageid="984502ac-2969-4045-a2e3-825d181d5c19" name="Block2" type="Block">
    <subsheetid>dab928dd-5fd3-48ef-9756-4d64792ab888</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>-90</displayx>
    <displayy>15</displayy>
    <displaywidth>240</displaywidth>
    <displayheight>60</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="4d0ccb24-3e66-4da0-bda7-ebe729a50f9b" name="Connect IMAP" type="SubSheet">
    <subsheetid>aca4df97-d2e0-4cfe-9a50-a8628baf8707</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-15</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>cb46fabe-2880-47fa-95cc-de9bf949ab7e</onsuccess>
    <processid>a07911cf-dcf6-46b7-9f4b-821156df7559</processid>
  </stage>
  <stage stageid="cb46fabe-2880-47fa-95cc-de9bf949ab7e" name="Login" type="SubSheet">
    <subsheetid>aca4df97-d2e0-4cfe-9a50-a8628baf8707</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>45</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>3bb683b2-a757-4dd9-a0ea-b47fa936caf4</onsuccess>
    <processid>dab928dd-5fd3-48ef-9756-4d64792ab888</processid>
  </stage>
  <stage stageid="bbe87838-407a-48d3-b46a-be8428c903e5" name="Logout" type="SubSheet">
    <subsheetid>aca4df97-d2e0-4cfe-9a50-a8628baf8707</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>165</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>d126c08a-2ada-4924-99d7-38dd2927788d</onsuccess>
    <processid>c227143e-75fe-4016-b5a7-7d6cfe85443f</processid>
  </stage>
  <stage stageid="6cd2f0cd-8ba8-4d0a-ac55-63120d11bcc0" name="Is Recipient Absent?" type="Decision">
    <subsheetid>aca4df97-d2e0-4cfe-9a50-a8628baf8707</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>15</displayx>
    <displayy>-90</displayy>
    <displaywidth>150</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <decision expression="Trim([To])=&quot;&quot;" />
    <ontrue>102f627c-791f-4e0a-bf79-3f0c07f59bee</ontrue>
    <onfalse>4d0ccb24-3e66-4da0-bda7-ebe729a50f9b</onfalse>
  </stage>
  <stage stageid="102f627c-791f-4e0a-bf79-3f0c07f59bee" name="BE-Invalid Recipient" type="Exception">
    <subsheetid>aca4df97-d2e0-4cfe-9a50-a8628baf8707</subsheetid>
    <narrative>
    </narrative>
    <displayx>150</displayx>
    <displayy>-90</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <exception type="Business Exception" detail="&quot;Invalid Input For Mail Receiver&quot;" />
  </stage>
  <stage stageid="12212015-6074-42f0-bdf9-22987ae7e832" name="Is FolderName Valid?" type="Decision">
    <subsheetid>572ab18e-33ed-4088-b341-0c8fc5ec05a7</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>0</displayx>
    <displayy>-120</displayy>
    <displaywidth>120</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <decision expression="Trim([foldername])&lt;&gt;&quot;&quot;" />
    <ontrue>cfec885b-edfd-4b0d-8ce4-3a1285624e94</ontrue>
    <onfalse>cb6f9798-7ca7-49e8-a62c-c1aef59e7fe8</onfalse>
  </stage>
  <stage stageid="cb6f9798-7ca7-49e8-a62c-c1aef59e7fe8" name="BE-Invalid Input" type="Exception">
    <subsheetid>572ab18e-33ed-4088-b341-0c8fc5ec05a7</subsheetid>
    <narrative>
    </narrative>
    <displayx>180</displayx>
    <displayy>-120</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <exception type="Business Exception" detail="&quot;Invalid Input For Folder&quot;" />
  </stage>
  <stage stageid="a378c735-656d-4c78-9647-2d95412f1d8f" name="Set Exception Message" type="Calculation">
    <subsheetid>342cb078-d25f-47a6-9c05-02880b01ae5e</subsheetid>
    <loginhibit />
    <narrative>
    </narrative>
    <displayx>180</displayx>
    <displayy>270</displayy>
    <displaywidth>60</displaywidth>
    <displayheight>30</displayheight>
    <font family="Segoe UI" size="10" style="Regular" color="000000" />
    <onsuccess>2d6748c5-b570-47dd-a1f5-c2c1a808d6c3</onsuccess>
    <calculation expression="&quot;Configuration Failed. Missing Field: &quot;&amp;Left([Exception Message], Len([Exception Message])-2)" stage="Exception Message" />
  </stage>
</process>